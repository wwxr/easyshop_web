define("echarts/chart/radar",["require","../component/base","./base","zrender/shape/Polygon","../component/polar","../config","../util/ecData","zrender/tool/util","zrender/tool/color","../util/accMath","../chart"],function(h){function k(p,l,i,q,n){g.call(this,p,l,i,q,n),d.call(this),this.refresh(q)}var g=h("../component/base"),d=h("./base"),j=h("zrender/shape/Polygon");h("../component/polar");var c=h("../config"),m=h("../util/ecData"),b=h("zrender/tool/util"),f=h("zrender/tool/color");return k.prototype={type:c.CHART_TYPE_RADAR,_buildShape:function(){this.selectedMap={},this._symbol=this.option.symbolList,this._queryTarget,this._dropBoxList=[],this._radarDataCounter=0;for(var q,p=this.series,o=this.component.legend,r=0,l=p.length;l>r;r++){p[r].type===c.CHART_TYPE_RADAR&&(this.serie=this.reformOption(p[r]),this.legendHoverLink=p[r].legendHoverLink||this.legendHoverLink,q=this.serie.name||"",this.selectedMap[q]=o?o.isSelected(q):!0,this.selectedMap[q]&&(this._queryTarget=[this.serie,this.option],this.deepQuery(this._queryTarget,"calculable")&&this._addDropBox(r),this._buildSingleRadar(r),this.buildMark(r)))}this.addShapeList()},_buildSingleRadar:function(x){for(var z,w,u,y,q=this.component.legend,A=this.serie.data,p=this.deepQuery(this._queryTarget,"calculable"),v=0;v<A.length;v++){u=A[v].name||"",this.selectedMap[u]=q?q.isSelected(u):!0,this.selectedMap[u]&&(q?(w=q.getColor(u),z=q.getItemShape(u),z&&(z.style.brushType=this.deepQuery([A[v],this.serie],"itemStyle.normal.areaStyle")?"both":"stroke",q.setItemShape(u,z))):w=this.zr.getColor(v),y=this._getPointList(this.serie.polarIndex,A[v]),this._addSymbol(y,w,v,x,this.serie.polarIndex),this._addDataShape(y,w,A[v],x,v,p),this._radarDataCounter++)}},_getPointList:function(w,q){for(var p,y,l=[],x=this.component.polar,u=0,v=q.value.length;v>u;u++){y=null!=q.value[u].value?q.value[u].value:q.value[u],p="-"!=y?x.getVector(w,u,y):!1,p&&l.push(p)}return l},_addSymbol:function(x,A,v,s,z){for(var q,p=this.series,u=this.component.polar,w=0,y=x.length;y>w;w++){q=this.getSymbolShape(this.deepMerge([p[s].data[v],p[s]]),s,p[s].data[v].value[w],w,u.getIndicatorText(z,w),x[w][0],x[w][1],this._symbol[this._radarDataCounter%this._symbol.length],A,"#fff","vertical"),q.zlevel=this._zlevelBase+1,m.set(q,"data",p[s].data[v]),m.set(q,"value",p[s].data[v].value),m.set(q,"dataIndex",v),m.set(q,"special",w),this.shapeList.push(q)}},_addDataShape:function(A,E,y,s,q,a){var z=this.series,B=[y,this.serie],w=this.getItemStyleColor(this.deepQuery(B,"itemStyle.normal.color"),s,q,y),C=this.deepQuery(B,"itemStyle.normal.lineStyle.width"),l=this.deepQuery(B,"itemStyle.normal.lineStyle.type"),D=this.deepQuery(B,"itemStyle.normal.areaStyle.color"),v=this.deepQuery(B,"itemStyle.normal.areaStyle"),x={zlevel:this._zlevelBase,style:{pointList:A,brushType:v?"both":"stroke",color:D||w||("string"==typeof E?f.alpha(E,0.5):E),strokeColor:w||E,lineWidth:C,lineType:l},highlightStyle:{brushType:this.deepQuery(B,"itemStyle.emphasis.areaStyle")||v?"both":"stroke",color:this.deepQuery(B,"itemStyle.emphasis.areaStyle.color")||D||w||("string"==typeof E?f.alpha(E,0.5):E),strokeColor:this.getItemStyleColor(this.deepQuery(B,"itemStyle.emphasis.color"),s,q,y)||w||E,lineWidth:this.deepQuery(B,"itemStyle.emphasis.lineStyle.width")||C,lineType:this.deepQuery(B,"itemStyle.emphasis.lineStyle.type")||l}};m.pack(x,z[s],s,y,q,y.name,this.component.polar.getIndicator(z[s].polarIndex)),a&&(x.draggable=!0,this.setCalculable(x)),x=new j(x),this.shapeList.push(x)},_addDropBox:function(o){var l=this.series,a=this.deepQuery(this._queryTarget,"polarIndex");if(!this._dropBoxList[a]){var p=this.component.polar.getDropBox(a);p.zlevel=this._zlevelBase,this.setCalculable(p),m.pack(p,l,o,void 0,-1),this.shapeList.push(p),this._dropBoxList[a]=!0}},ondragend:function(r,q){var p=this.series;if(this.isDragend&&r.target){var u=r.target,l=m.get(u,"seriesIndex"),s=m.get(u,"dataIndex");this.component.legend&&this.component.legend.del(p[l].data[s].name),p[l].data.splice(s,1),q.dragOut=!0,q.needRefresh=!0,this.isDragend=!1}},ondrop:function(C,x){var u=this.series;if(this.isDrop&&C.target){var B,s,e=C.target,w=C.dragged,y=m.get(e,"seriesIndex"),z=m.get(e,"dataIndex"),v=this.component.legend;if(-1===z){B={value:m.get(w,"value"),name:m.get(w,"name")},u[y].data.push(B),v&&v.add(B.name,w.style.color||w.style.strokeColor)}else{var A=h("../util/accMath");B=u[y].data[z],v&&v.del(B.name),B.name+=this.option.nameConnector+m.get(w,"name"),s=m.get(w,"value");for(var q=0;q<s.length;q++){B.value[q]=A.accAdd(B.value[q],s[q])}v&&v.add(B.name,w.style.color||w.style.strokeColor)}x.dragIn=x.dragIn||!0,this.isDrop=!1}},refresh:function(a){a&&(this.option=a,this.series=a.series),this.backupShapeList(),this._buildShape()}},b.inherits(k,d),b.inherits(k,g),h("../chart").define("radar",k),k}),define("echarts/component/polar",["require","./base","zrender/shape/Text","zrender/shape/Line","zrender/shape/Polygon","zrender/shape/Circle","zrender/shape/Ring","../config","zrender/tool/util","../util/coordinates","../util/accMath","../util/smartSteps","../component"],function(m){function u(i,h,r,d,l){j.call(this,i,h,r,d,l),this.refresh(d)}var j=m("./base"),f=m("zrender/shape/Text"),q=m("zrender/shape/Line"),c=m("zrender/shape/Polygon"),v=m("zrender/shape/Circle"),b=m("zrender/shape/Ring"),g=m("../config"),k=m("zrender/tool/util"),p=m("../util/coordinates");return u.prototype={type:g.COMPONENT_TYPE_POLAR,_buildShape:function(){for(var a=0;a<this.polar.length;a++){this._index=a,this.reformOption(this.polar[a]),this._queryTarget=[this.polar[a],this.option],this._createVector(a),this._buildSpiderWeb(a),this._buildText(a),this._adjustIndicatorValue(a),this._addAxisLabel(a)}for(var a=0;a<this.shapeList.length;a++){this.zr.addShape(this.shapeList[a])}},_createVector:function(B){for(var D,z=this.polar[B],x=this.deepQuery(this._queryTarget,"indicator"),C=x.length,w=z.startAngle,E=2*Math.PI/C,d=this._getRadius(),y=z.__ecIndicator=[],A=0;C>A;A++){D=p.polar2cartesian(d,w*Math.PI/180+E*A),y.push({vector:[D[1],-D[0]]})}},_getRadius:function(){var a=this.polar[this._index];return this.parsePercent(a.radius,Math.min(this.zr.getWidth(),this.zr.getHeight())/2)},_buildSpiderWeb:function(C){var F=this.polar[C],A=F.__ecIndicator,y=F.splitArea,E=F.splitLine,x=this.getCenter(C),G=F.splitNumber,w=E.lineStyle.color,z=E.lineStyle.width,B=E.show,D=this.deepQuery(this._queryTarget,"axisLine");this._addArea(A,G,x,y,w,z,B),D.show&&this._addLine(A,x,D)},_addAxisLabel:function(x){for(var F,K,C,z,K,A,E,I,D,J,B=m("../util/accMath"),w=this.polar[x],e=this.deepQuery(this._queryTarget,"indicator"),h=w.__ecIndicator,G=this.deepQuery(this._queryTarget,"splitNumber"),n=this.getCenter(x),H=0;H<e.length;H++){if(F=this.deepQuery([e[H],w,this.option],"axisLabel"),F.show){if(C={},C.textFont=this.getFont(),C=k.merge(C,F),C.lineWidth=C.width,K=h[H].vector,A=h[H].value,I=H/e.length*2*Math.PI,D=F.offset||10,J=F.interval||0,!A){return}for(var L=1;G>=L;L+=J+1){z=k.merge({},C),E=B.accAdd(A.min,B.accMul(A.step,L)),z.text=this.numAddCommas(E),z.x=L*K[0]/G+Math.cos(I)*D+n[0],z.y=L*K[1]/G+Math.sin(I)*D+n[1],this.shapeList.push(new f({zlevel:this._zlevelBase,style:z,draggable:!1,hoverable:!1}))}}}},_buildText:function(D){for(var I,B,G,x,J,n,A,C=this.polar[D],E=C.__ecIndicator,z=this.deepQuery(this._queryTarget,"indicator"),F=this.getCenter(D),w=0,H=0,y=0;y<z.length;y++){x=this.deepQuery([z[y],C,this.option],"name"),x.show&&(A=this.deepQuery([x,C,this.option],"textStyle"),B={},B.textFont=this.getFont(A),B.color=A.color,B.text="function"==typeof x.formatter?x.formatter.call(this.myChart,z[y].text,y):"string"==typeof x.formatter?x.formatter.replace("{value}",z[y].text):z[y].text,E[y].text=B.text,I=E[y].vector,G=Math.round(I[0])>0?"left":Math.round(I[0])<0?"right":"center",x.margin?(n=x.margin,w=I[0]>0?n:-n,H=I[1]>0?n:-n,w=0===I[0]?0:w,H=0===I[1]?0:H,I=this._mapVector(I,F,1)):I=this._mapVector(I,F,1.2),B.textAlign=G,B.x=I[0]+w,B.y=I[1]+H,J=x.rotate?[x.rotate/180*Math.PI,I[0],I[1]]:[0,0,0],this.shapeList.push(new f({zlevel:this._zlevelBase,style:B,draggable:!1,hoverable:!1,rotation:J})))}},getIndicatorText:function(d,a){return this.polar[d]&&this.polar[d].__ecIndicator[a]&&this.polar[d].__ecIndicator[a].text},getDropBox:function(B){var D,z,B=B||0,x=this.polar[B],C=this.getCenter(B),w=x.__ecIndicator,E=w.length,d=[],y=x.type;if("polygon"==y){for(var A=0;E>A;A++){D=w[A].vector,d.push(this._mapVector(D,C,1.2))}z=this._getShape(d,"fill","rgba(0,0,0,0)","",1)}else{"circle"==y&&(z=this._getCircle("",1,1.2,C,"fill","rgba(0,0,0,0)"))}return z},_addArea:function(D,H,B,y,G,x,I){for(var w,A,C,E,z=this.deepQuery(this._queryTarget,"type"),F=0;H>F;F++){A=(H-F)/H,I&&("polygon"==z?(E=this._getPointList(D,A,B),w=this._getShape(E,"stroke","",G,x)):"circle"==z&&(w=this._getCircle(G,x,A,B,"stroke")),this.shapeList.push(w)),y.show&&(C=(H-F-1)/H,this._addSplitArea(D,y,A,C,B,F))}},_getCircle:function(w,l,h,y,d,x){var s=this._getRadius();return new v({zlevel:this._zlevelBase,style:{x:y[0],y:y[1],r:s*h,brushType:d,strokeColor:w,lineWidth:l,color:x},hoverable:!1,draggable:!1})},_getRing:function(o,l,h,r){var d=this._getRadius();return new b({zlevel:this._zlevelBase,style:{x:r[0],y:r[1],r:l*d,r0:h*d,color:o,brushType:"fill"},hoverable:!1,draggable:!1})},_getPointList:function(w,l,h){for(var y,d=[],x=w.length,r=0;x>r;r++){y=w[r].vector,d.push(this._mapVector(y,h,l))}return d},_getShape:function(o,l,h,r,d){return new c({zlevel:this._zlevelBase,style:{pointList:o,brushType:l,color:h,strokeColor:r,lineWidth:d},hoverable:!1,draggable:!1})},_addSplitArea:function(F,K,D,z,I,y){var L,w,C,E,G,B=F.length,H=K.areaStyle.color,x=[],B=F.length,J=this.deepQuery(this._queryTarget,"type");if("string"==typeof H&&(H=[H]),w=H.length,L=H[y%w],"polygon"==J){for(var A=0;B>A;A++){x=[],C=F[A].vector,E=F[(A+1)%B].vector,x.push(this._mapVector(C,I,D)),x.push(this._mapVector(C,I,z)),x.push(this._mapVector(E,I,z)),x.push(this._mapVector(E,I,D)),G=this._getShape(x,"fill",L,"",1),this.shapeList.push(G)}}else{"circle"==J&&(G=this._getRing(L,D,z,I),this.shapeList.push(G))}},_mapVector:function(h,d,a){return[h[0]*a+d[0],h[1]*a+d[1]]},getCenter:function(a){var a=a||0;return this.parseCenter(this.zr,this.polar[a].center)},_addLine:function(C,F,A){for(var y,E,x=C.length,G=A.lineStyle,w=G.color,z=G.width,B=G.type,D=0;x>D;D++){E=C[D].vector,y=this._getLine(F[0],F[1],E[0]+F[0],E[1]+F[1],w,z,B),this.shapeList.push(y)}},_getLine:function(w,d,a,y,x,h,l){return new q({zlevel:this._zlevelBase,style:{xStart:w,yStart:d,xEnd:a,yEnd:y,strokeColor:x,lineWidth:h,lineType:l},hoverable:!1})},_adjustIndicatorValue:function(I){for(var C,y,G=this.polar[I],x=this.deepQuery(this._queryTarget,"indicator"),J=x.length,e=G.__ecIndicator,B=this._getSeriesData(I),D=G.boundaryGap,E=G.splitNumber,A=G.scale,F=m("../util/smartSteps"),w=0;J>w;w++){if("number"==typeof x[w].max){C=x[w].max,y=x[w].min||0}else{var H=this._findValue(B,w,E,D);y=H.min,C=H.max}!A&&y>=0&&C>=0&&(y=0),!A&&0>=y&&0>=C&&(C=0);var z=F(y,C,E);e[w].value={min:z.min,max:z.max,step:z.step}}},_getSeriesData:function(y){for(var l,h,A,d=[],z=this.component.legend,w=0;w<this.series.length;w++){if(l=this.series[w],l.type==g.CHART_TYPE_RADAR){h=l.data||[];for(var x=0;x<h.length;x++){A=this.deepQuery([h[x],l,this.option],"polarIndex")||0,A!=y||z&&!z.isSelected(h[x].name)||d.push(h[x])}}}return d},_findValue:function(C,F,A,y){function E(a){(a>x||void 0===x)&&(x=a),(G>a||void 0===G)&&(G=a)}var x,G,w,z;if(C&&0!==C.length){if(1==C.length&&(G=0),1!=C.length){for(var B=0;B<C.length;B++){w="undefined"!=typeof C[B].value[F].value?C[B].value[F].value:C[B].value[F],E(w)}}else{z=C[0];for(var B=0;B<z.value.length;B++){E("undefined"!=typeof z.value[B].value?z.value[B].value:z.value[B])}}var D=Math.abs(x-G);return G-=Math.abs(D*y[0]),x+=Math.abs(D*y[1]),G===x&&(0===x?x=1:x>0?G=x/A:x/=A),{max:x,min:G}}},getVector:function(B,D,z){B=B||0,D=D||0;var x=this.polar[B].__ecIndicator;if(!(D>=x.length)){var C,w=this.polar[B].__ecIndicator[D],E=this.getCenter(B),d=w.vector,y=w.value.max,A=w.value.min;if("undefined"==typeof z){return E}switch(z){case"min":z=A;break;case"max":z=y;break;case"center":z=(y+A)/2}return C=y!=A?(z-A)/(y-A):0.5,this._mapVector(d,E,C)}},isInside:function(d){var a=this.getNearestIndex(d);return a?a.polarIndex:-1},getNearestIndex:function(C){for(var E,A,x,D,w,F,d,z,B,y=0;y<this.polar.length;y++){if(E=this.polar[y],A=this.getCenter(y),C[0]==A[0]&&C[1]==A[1]){return{polarIndex:y,valueIndex:0}}if(x=this._getRadius(),w=E.startAngle,F=E.indicator,d=F.length,z=2*Math.PI/d,D=p.cartesian2polar(C[0]-A[0],A[1]-C[1]),C[0]-A[0]<0&&(D[1]+=Math.PI),D[1]<0&&(D[1]+=2*Math.PI),B=D[1]-w/180*Math.PI+2*Math.PI,Math.abs(Math.cos(B%(z/2)))*x>D[0]){return{polarIndex:y,valueIndex:Math.floor((B+z/2)/z)%d}}}},getIndicator:function(a){var a=a||0;return this.polar[a].indicator},refresh:function(a){a&&(this.option=a,this.polar=this.option.polar,this.series=this.option.series),this.clear(),this._buildShape()}},k.inherits(u,j),m("../component").define("polar",u),u}),define("echarts/util/coordinates",["require","zrender/tool/math"],function(c){function b(g,f){return[g*d.sin(f),g*d.cos(f)]}function a(g,f){return[Math.sqrt(g*g+f*f),Math.atan(f/g)]}var d=c("zrender/tool/math");return{polar2cartesian:b,cartesian2polar:a}});