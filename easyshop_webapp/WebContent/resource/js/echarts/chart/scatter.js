define("echarts/chart/scatter",["require","../component/base","./base","../util/shape/Symbol","../component/axis","../component/grid","../component/dataZoom","../component/dataRange","../config","zrender/tool/util","zrender/tool/color","../chart"],function(h){function d(n,l,i,p,m){c.call(this,n,l,i,p,m),k.call(this),this.refresh(p)}var c=h("../component/base"),k=h("./base"),b=h("../util/shape/Symbol");h("../component/axis"),h("../component/grid"),h("../component/dataZoom"),h("../component/dataRange");var j=h("../config"),f=h("zrender/tool/util"),g=h("zrender/tool/color");return d.prototype={type:j.CHART_TYPE_SCATTER,_buildShape:function(){var r=this.series;this._sIndex2ColorMap={},this._symbol=this.option.symbolList,this._sIndex2ShapeMap={},this.selectedMap={},this.xMarkMap={};for(var w,p,m,v,x=this.component.legend,o=[],q=0,u=r.length;u>q;q++){if(w=r[q],p=w.name,w.type===j.CHART_TYPE_SCATTER){if(r[q]=this.reformOption(r[q]),this.legendHoverLink=r[q].legendHoverLink||this.legendHoverLink,this._sIndex2ShapeMap[q]=this.query(w,"symbol")||this._symbol[q%this._symbol.length],x){if(this.selectedMap[p]=x.isSelected(p),this._sIndex2ColorMap[q]=g.alpha(x.getColor(p),0.5),m=x.getItemShape(p)){var v=this._sIndex2ShapeMap[q];m.style.brushType=v.match("empty")?"stroke":"both",v=v.replace("empty","").toLowerCase(),v.match("rectangle")&&(m.style.x+=Math.round((m.style.width-m.style.height)/2),m.style.width=m.style.height),v.match("star")&&(m.style.n=v.replace("star","")-0||5,v="star"),v.match("image")&&(m.style.image=v.replace(new RegExp("^image:\\/\\/"),""),m.style.x+=Math.round((m.style.width-m.style.height)/2),m.style.width=m.style.height,v="image"),m.style.iconType=v,x.setItemShape(p,m)}}else{this.selectedMap[p]=!0,this._sIndex2ColorMap[q]=g.alpha(this.zr.getColor(q),0.5)}this.selectedMap[p]&&o.push(q)}}this._buildSeries(o),this.addShapeList()},_buildSeries:function(C){if(0!==C.length){for(var H,A,x,F,w,I,q,z,B=this.series,D={},y=0,E=C.length;E>y;y++){if(H=C[y],A=B[H],0!==A.data.length){w=this.component.xAxis.getAxis(A.xAxisIndex||0),I=this.component.yAxis.getAxis(A.yAxisIndex||0),D[H]=[];for(var v=0,G=A.data.length;G>v;v++){x=A.data[v],F=null!=x?null!=x.value?x.value:x:"-","-"===F||F.length<2||(q=w.getCoord(F[0]),z=I.getCoord(F[1]),D[H].push([q,z,v,x.name||""]))}this.xMarkMap[H]=this._markMap(w,I,A.data,D[H]),this.buildMark(H)}}this._buildPointList(D)}},_markMap:function(B,F,z,w){for(var E,v={min0:Number.POSITIVE_INFINITY,max0:Number.NEGATIVE_INFINITY,sum0:0,counter0:0,average0:0,min1:Number.POSITIVE_INFINITY,max1:Number.NEGATIVE_INFINITY,sum1:0,counter1:0,average1:0},G=0,q=w.length;q>G;G++){E=z[w[G][2]].value||z[w[G][2]],v.min0>E[0]&&(v.min0=E[0],v.minY0=w[G][1],v.minX0=w[G][0]),v.max0<E[0]&&(v.max0=E[0],v.maxY0=w[G][1],v.maxX0=w[G][0]),v.sum0+=E[0],v.counter0++,v.min1>E[1]&&(v.min1=E[1],v.minY1=w[G][1],v.minX1=w[G][0]),v.max1<E[1]&&(v.max1=E[1],v.maxY1=w[G][1],v.maxX1=w[G][0]),v.sum1+=E[1],v.counter1++}var y=this.component.grid.getX(),A=this.component.grid.getXend(),C=this.component.grid.getY(),x=this.component.grid.getYend();v.average0=(v.sum0/v.counter0).toFixed(2)-0;var D=B.getCoord(v.average0);v.averageLine0=[[D,x],[D,C]],v.minLine0=[[v.minX0,x],[v.minX0,C]],v.maxLine0=[[v.maxX0,x],[v.maxX0,C]],v.average1=(v.sum1/v.counter1).toFixed(2)-0;var u=F.getCoord(v.average1);return v.averageLine1=[[y,u],[A,u]],v.minLine1=[[y,v.minY1],[A,v.minY1]],v.maxLine1=[[y,v.maxY1],[A,v.maxY1]],v},_buildPointList:function(w){var y,v,q,x,p=this.series;for(var z in w){if(y=p[z],v=w[z],y.large&&y.data.length>y.largeThreshold){this.shapeList.push(this._getLargeSymbol(v,this.getItemStyleColor(this.query(y,"itemStyle.normal.color"),z,-1)||this._sIndex2ColorMap[z]))}else{for(var m=0,u=v.length;u>m;m++){q=v[m],x=this._getSymbol(z,q[2],q[3],q[0],q[1]),x&&this.shapeList.push(x)}}}},_getSymbol:function(x,A,v,q,z){var p,B=this.series,m=B[x],u=m.data[A],w=this.component.dataRange;if(w){if(p=isNaN(u[2])?this._sIndex2ColorMap[x]:w.getColor(u[2]),!p){return null}}else{p=this._sIndex2ColorMap[x]}var y=this.getSymbolShape(m,x,u,A,v,q,z,this._sIndex2ShapeMap[x],p,"rgba(0,0,0,0)","vertical");return y.zlevel=this._zlevelBase,y._main=!0,y},_getLargeSymbol:function(i,a){return new b({zlevel:this._zlevelBase,_main:!0,hoverable:!1,style:{pointList:i,color:a,strokeColor:a},highlightStyle:{pointList:[]}})},getMarkCoord:function(v,p){var m,x=this.series[v],l=this.xMarkMap[v],w=this.component.xAxis.getAxis(x.xAxisIndex),q=this.component.yAxis.getAxis(x.yAxisIndex);if(!p.type||"max"!==p.type&&"min"!==p.type&&"average"!==p.type){m=["string"!=typeof p.xAxis&&w.getCoordByIndex?w.getCoordByIndex(p.xAxis||0):w.getCoord(p.xAxis||0),"string"!=typeof p.yAxis&&q.getCoordByIndex?q.getCoordByIndex(p.yAxis||0):q.getCoord(p.yAxis||0)]}else{var u=null!=p.valueIndex?p.valueIndex:1;m=[l[p.type+"X"+u],l[p.type+"Y"+u],l[p.type+"Line"+u],l[p.type+u]]}return m},refresh:function(a){a&&(this.option=a,this.series=a.series),this.backupShapeList(),this._buildShape()},ondataRange:function(i,a){this.component.dataRange&&(this.refresh(),a.needRefresh=!0)}},f.inherits(d,k),f.inherits(d,c),h("../chart").define("scatter",d),d}),define("echarts/component/dataRange",["require","./base","zrender/shape/Text","zrender/shape/Rectangle","../util/shape/HandlePolygon","../config","zrender/tool/util","zrender/tool/event","zrender/tool/area","zrender/tool/color","../component"],function(m){function u(l,h,w,d,s){if("undefined"==typeof this.query(d,"dataRange.min")||"undefined"==typeof this.query(d,"dataRange.max")){return void console.error("option.dataRange.min or option.dataRange.max has not been defined.")}j.call(this,l,h,w,d,s);var i=this;i._ondrift=function(n,a){return i.__ondrift(this,n,a)},i._ondragend=function(){return i.__ondragend()},i._dataRangeSelected=function(a){return i.__dataRangeSelected(a)},i._dispatchHoverLink=function(a){return i.__dispatchHoverLink(a)},i._onhoverlink=function(a){return i.__onhoverlink(a)},this._selectedMap={},this._range={},this.refresh(d),h.bind(v.EVENT.HOVER,this._onhoverlink)}var j=m("./base"),f=m("zrender/shape/Text"),q=m("zrender/shape/Rectangle"),c=m("../util/shape/HandlePolygon"),v=m("../config"),b=m("zrender/tool/util"),g=m("zrender/tool/event"),k=m("zrender/tool/area"),p=m("zrender/tool/color");return u.prototype={type:v.COMPONENT_TYPE_DATARANGE,_textGap:10,_buildShape:function(){if(this._itemGroupLocation=this._getItemGroupLocation(),this._buildBackground(),this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?this._buildGradient():this._buildItem(),this.dataRangeOption.show){for(var d=0,a=this.shapeList.length;a>d;d++){this.zr.addShape(this.shapeList[d])}}this._syncShapeFromRange()},_buildItem:function(){var C,G,A,n,H=this._valueTextList,a=H.length,z=this.getFont(this.dataRangeOption.textStyle),D=this._itemGroupLocation.x,x=this._itemGroupLocation.y,E=this.dataRangeOption.itemWidth,h=this.dataRangeOption.itemHeight,F=this.dataRangeOption.itemGap,w=k.getTextHeight("国",z);"vertical"==this.dataRangeOption.orient&&"right"==this.dataRangeOption.x&&(D=this._itemGroupLocation.x+this._itemGroupLocation.width-E);var y=!0;this.dataRangeOption.text&&(y=!1,this.dataRangeOption.text[0]&&(A=this._getTextShape(D,x,this.dataRangeOption.text[0]),"horizontal"==this.dataRangeOption.orient?D+=k.getTextWidth(this.dataRangeOption.text[0],z)+this._textGap:(x+=w+this._textGap,A.style.y+=w/2+this._textGap,A.style.textBaseline="bottom"),this.shapeList.push(new f(A))));for(var B=0;a>B;B++){C=H[B],n=this.getColorByIndex(B),G=this._getItemShape(D,x,E,h,this._selectedMap[B]?n:"#ccc"),G._idx=B,G.onmousemove=this._dispatchHoverLink,G.onclick=this._dataRangeSelected,this.shapeList.push(new q(G)),y&&(A={zlevel:this._zlevelBase,style:{x:D+E+5,y:x,color:this._selectedMap[B]?this.dataRangeOption.textStyle.color:"#ccc",text:H[B],textFont:z,textBaseline:"top"},highlightStyle:{brushType:"fill"},clickable:!0},"vertical"==this.dataRangeOption.orient&&"right"==this.dataRangeOption.x&&(A.style.x-=E+10,A.style.textAlign="right"),A._idx=B,A.onclick=this._dataRangeSelected,this.shapeList.push(new f(A))),"horizontal"==this.dataRangeOption.orient?D+=E+(y?5:0)+(y?k.getTextWidth(C,z):0)+F:x+=h+F}!y&&this.dataRangeOption.text[1]&&("horizontal"==this.dataRangeOption.orient?D=D-F+this._textGap:x=x-F+this._textGap,A=this._getTextShape(D,x,this.dataRangeOption.text[1]),"horizontal"!=this.dataRangeOption.orient&&(A.style.y-=5,A.style.textBaseline="top"),this.shapeList.push(new f(A)))},_buildGradient:function(){var E,z,h=this.getFont(this.dataRangeOption.textStyle),F=this._itemGroupLocation.x,a=this._itemGroupLocation.y,y=this.dataRangeOption.itemWidth,B=this.dataRangeOption.itemHeight,w=k.getTextHeight("国",h),C=!0;this.dataRangeOption.text&&(C=!1,this.dataRangeOption.text[0]&&(z=this._getTextShape(F,a,this.dataRangeOption.text[0]),"horizontal"==this.dataRangeOption.orient?F+=k.getTextWidth(this.dataRangeOption.text[0],h)+this._textGap:(a+=w+this._textGap,z.style.y+=w/2+this._textGap,z.style.textBaseline="bottom"),this.shapeList.push(new f(z))));for(var e=m("zrender/tool/color"),D=1/(this.dataRangeOption.color.length-1),n=[],x=0,A=this.dataRangeOption.color.length;A>x;x++){n.push([x*D,this.dataRangeOption.color[x]])}"horizontal"==this.dataRangeOption.orient?(E={zlevel:this._zlevelBase,style:{x:F,y:a,width:10*y,height:B,color:e.getLinearGradient(F,a,F+10*y,a,n)},hoverable:!1},F+=10*y+this._textGap):(E={zlevel:this._zlevelBase,style:{x:F,y:a,width:y,height:10*B,color:e.getLinearGradient(F,a,F,a+10*B,n)},hoverable:!1},a+=10*B+this._textGap),this.shapeList.push(new q(E)),this._calculableLocation=E.style,this.dataRangeOption.calculable&&(this._buildFiller(),this._bulidMask(),this._bulidHandle()),this._buildIndicator(),!C&&this.dataRangeOption.text[1]&&(z=this._getTextShape(F,a,this.dataRangeOption.text[1]),this.shapeList.push(new f(z)))},_buildIndicator:function(){var x,l,h=this._calculableLocation.x,y=this._calculableLocation.y,d=this._calculableLocation.width,o=this._calculableLocation.height,w=5;"horizontal"==this.dataRangeOption.orient?"bottom"!=this.dataRangeOption.y?(x=[[h,y+o],[h-w,y+o+w],[h+w,y+o+w]],l="bottom"):(x=[[h,y],[h-w,y-w],[h+w,y-w]],l="top"):"right"!=this.dataRangeOption.x?(x=[[h+d,y],[h+d+w,y-w],[h+d+w,y+w]],l="right"):(x=[[h,y],[h-w,y-w],[h-w,y+w]],l="left"),this._indicatorShape={style:{pointList:x,color:"#fff",__rect:{x:Math.min(x[0][0],x[1][0]),y:Math.min(x[0][1],x[1][1]),width:w*("horizontal"==this.dataRangeOption.orient?2:1),height:w*("horizontal"==this.dataRangeOption.orient?1:2)}},highlightStyle:{brushType:"fill",textPosition:l,textColor:this.dataRangeOption.textStyle.color},hoverable:!1},this._indicatorShape=new c(this._indicatorShape)},_buildFiller:function(){this._fillerShape={zlevel:this._zlevelBase+1,style:{x:this._calculableLocation.x,y:this._calculableLocation.y,width:this._calculableLocation.width,height:this._calculableLocation.height,color:"rgba(255,255,255,0)"},highlightStyle:{strokeColor:"rgba(255,255,255,0.5)",lineWidth:1},draggable:!0,ondrift:this._ondrift,ondragend:this._ondragend,onmousemove:this._dispatchHoverLink,_type:"filler"},this._fillerShape=new q(this._fillerShape),this.shapeList.push(this._fillerShape)},_bulidHandle:function(){var C,H,B,w,F,I,h,A,D=this._calculableLocation.x,y=this._calculableLocation.y,E=this._calculableLocation.width,o=this._calculableLocation.height,G=this.getFont(this.dataRangeOption.textStyle),x=k.getTextHeight("国",G),z=Math.max(k.getTextWidth(this._textFormat(this.dataRangeOption.max),G),k.getTextWidth(this._textFormat(this.dataRangeOption.min),G))+2;"horizontal"==this.dataRangeOption.orient?"bottom"!=this.dataRangeOption.y?(C=[[D,y],[D,y+o+x],[D-x,y+o+x],[D-1,y+o],[D-1,y]],H=D-z/2-x,B=y+o+x/2+2,w={x:D-z-x,y:y+o,width:z+x,height:x},F=[[D+E,y],[D+E,y+o+x],[D+E+x,y+o+x],[D+E+1,y+o],[D+E+1,y]],I=D+E+z/2+x,h=B,A={x:D+E,y:y+o,width:z+x,height:x}):(C=[[D,y+o],[D,y-x],[D-x,y-x],[D-1,y],[D-1,y+o]],H=D-z/2-x,B=y-x/2-2,w={x:D-z-x,y:y-x,width:z+x,height:x},F=[[D+E,y+o],[D+E,y-x],[D+E+x,y-x],[D+E+1,y],[D+E+1,y+o]],I=D+E+z/2+x,h=B,A={x:D+E,y:y-x,width:z+x,height:x}):(z+=x,"right"!=this.dataRangeOption.x?(C=[[D,y],[D+E+x,y],[D+E+x,y-x],[D+E,y-1],[D,y-1]],H=D+E+z/2+x/2,B=y-x/2,w={x:D+E,y:y-x,width:z+x,height:x},F=[[D,y+o],[D+E+x,y+o],[D+E+x,y+x+o],[D+E,y+1+o],[D,y+o+1]],I=H,h=y+o+x/2,A={x:D+E,y:y+o,width:z+x,height:x}):(C=[[D+E,y],[D-x,y],[D-x,y-x],[D,y-1],[D+E,y-1]],H=D-z/2-x/2,B=y-x/2,w={x:D-z-x,y:y-x,width:z+x,height:x},F=[[D+E,y+o],[D-x,y+o],[D-x,y+x+o],[D,y+1+o],[D+E,y+o+1]],I=H,h=y+o+x/2,A={x:D-z-x,y:y+o,width:z+x,height:x})),this._startShape={style:{pointList:C,text:this._textFormat(this.dataRangeOption.max),textX:H,textY:B,color:this.getColor(this.dataRangeOption.max),rect:w,x:C[0][0],y:C[0][1],_x:C[0][0],_y:C[0][1]}},this._startShape.highlightStyle={strokeColor:this._startShape.style.color,lineWidth:1},this._endShape={style:{pointList:F,text:this._textFormat(this.dataRangeOption.min),textX:I,textY:h,color:this.getColor(this.dataRangeOption.min),rect:A,x:F[0][0],y:F[0][1],_x:F[0][0],_y:F[0][1]}},this._endShape.highlightStyle={strokeColor:this._endShape.style.color,lineWidth:1},this._startShape.zlevel=this._endShape.zlevel=this._zlevelBase+1,this._startShape.draggable=this._endShape.draggable=!0,this._startShape.ondrift=this._endShape.ondrift=this._ondrift,this._startShape.ondragend=this._endShape.ondragend=this._ondragend,this._startShape.style.textColor=this._endShape.style.textColor=this.dataRangeOption.textStyle.color,this._startShape.style.textAlign=this._endShape.style.textAlign="center",this._startShape.style.textPosition=this._endShape.style.textPosition="specific",this._startShape.style.textBaseline=this._endShape.style.textBaseline="middle",this._startShape.style.width=this._endShape.style.width=0,this._startShape.style.height=this._endShape.style.height=0,this._startShape.style.textPosition=this._endShape.style.textPosition="specific",this._startShape=new c(this._startShape),this._endShape=new c(this._endShape),this.shapeList.push(this._startShape),this.shapeList.push(this._endShape)},_bulidMask:function(){var h=this._calculableLocation.x,d=this._calculableLocation.y,a=this._calculableLocation.width,l=this._calculableLocation.height;this._startMask={zlevel:this._zlevelBase+1,style:{x:h,y:d,width:"horizontal"==this.dataRangeOption.orient?0:a,height:"horizontal"==this.dataRangeOption.orient?l:0,color:"#ccc"},hoverable:!1},this._endMask={zlevel:this._zlevelBase+1,style:{x:"horizontal"==this.dataRangeOption.orient?h+a:h,y:"horizontal"==this.dataRangeOption.orient?d:d+l,width:"horizontal"==this.dataRangeOption.orient?0:a,height:"horizontal"==this.dataRangeOption.orient?l:0,color:"#ccc"},hoverable:!1},this._startMask=new q(this._startMask),this._endMask=new q(this._endMask),this.shapeList.push(this._startMask),this.shapeList.push(this._endMask)},_buildBackground:function(){var a=this.reformCssArray(this.dataRangeOption.padding);this.shapeList.push(new q({zlevel:this._zlevelBase,hoverable:!1,style:{x:this._itemGroupLocation.x-a[3],y:this._itemGroupLocation.y-a[0],width:this._itemGroupLocation.width+a[3]+a[1],height:this._itemGroupLocation.height+a[0]+a[2],brushType:0===this.dataRangeOption.borderWidth?"fill":"both",color:this.dataRangeOption.backgroundColor,strokeColor:this.dataRangeOption.borderColor,lineWidth:this.dataRangeOption.borderWidth}}))},_getItemGroupLocation:function(){var F=this._valueTextList,K=F.length,D=this.dataRangeOption.itemGap,y=this.dataRangeOption.itemWidth,I=this.dataRangeOption.itemHeight,x=0,L=0,h=this.getFont(this.dataRangeOption.textStyle),C=k.getTextHeight("国",h);if("horizontal"==this.dataRangeOption.orient){if(this.dataRangeOption.text||this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable){x=(this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?10*y+D:K*(y+D))+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[0]?k.getTextWidth(this.dataRangeOption.text[0],h)+this._textGap:0)+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[1]?k.getTextWidth(this.dataRangeOption.text[1],h)+this._textGap:0)}else{y+=5;for(var G=0;K>G;G++){x+=y+k.getTextWidth(F[G],h)+D}}x-=D,L=Math.max(C,I)}else{var A;if(this.dataRangeOption.text||this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable){L=(this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?10*I+D:K*(I+D))+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[0]?this._textGap+C:0)+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[1]?this._textGap+C:0),A=Math.max(k.getTextWidth(this.dataRangeOption.text&&this.dataRangeOption.text[0]||"",h),k.getTextWidth(this.dataRangeOption.text&&this.dataRangeOption.text[1]||"",h)),x=Math.max(y,A)}else{L=(I+D)*K,y+=5,A=0;for(var G=0;K>G;G++){A=Math.max(A,k.getTextWidth(F[G],h))}x=y+A}L-=D}var H,w=this.reformCssArray(this.dataRangeOption.padding),J=this.zr.getWidth();switch(this.dataRangeOption.x){case"center":H=Math.floor((J-x)/2);break;case"left":H=w[3]+this.dataRangeOption.borderWidth;break;case"right":H=J-x-w[1]-this.dataRangeOption.borderWidth;break;default:H=this.parsePercent(this.dataRangeOption.x,J),H=isNaN(H)?0:H}var z,B=this.zr.getHeight();switch(this.dataRangeOption.y){case"top":z=w[0]+this.dataRangeOption.borderWidth;break;case"bottom":z=B-L-w[2]-this.dataRangeOption.borderWidth;break;case"center":z=Math.floor((B-L)/2);break;default:z=this.parsePercent(this.dataRangeOption.y,B),z=isNaN(z)?0:z}if(this.dataRangeOption.calculable){var E=Math.max(k.getTextWidth(this.dataRangeOption.max,h),k.getTextWidth(this.dataRangeOption.min,h))+C;"horizontal"==this.dataRangeOption.orient?(E>H&&(H=E),H+x+E>J&&(H-=E)):(C>z&&(z=C),z+L+C>B&&(z-=C))}return{x:H,y:z,width:x,height:L}},_getTextShape:function(h,d,a){return{zlevel:this._zlevelBase,style:{x:"horizontal"==this.dataRangeOption.orient?h:this._itemGroupLocation.x+this._itemGroupLocation.width/2,y:"horizontal"==this.dataRangeOption.orient?this._itemGroupLocation.y+this._itemGroupLocation.height/2:d,color:this.dataRangeOption.textStyle.color,text:a,textFont:this.getFont(this.dataRangeOption.textStyle),textBaseline:"horizontal"==this.dataRangeOption.orient?"middle":"top",textAlign:"horizontal"==this.dataRangeOption.orient?"left":"center"},hoverable:!1}},_getItemShape:function(o,l,h,r,d){return{zlevel:this._zlevelBase,style:{x:o,y:l+1,width:h,height:r-2,color:d},highlightStyle:{strokeColor:d,lineWidth:1},clickable:!0}},__ondrift:function(w,l,h){var y=this._calculableLocation.x,d=this._calculableLocation.y,x=this._calculableLocation.width,r=this._calculableLocation.height;return"horizontal"==this.dataRangeOption.orient?w.style.x+l<=y?w.style.x=y:w.style.x+l+w.style.width>=y+x?w.style.x=y+x-w.style.width:w.style.x+=l:w.style.y+h<=d?w.style.y=d:w.style.y+h+w.style.height>=d+r?w.style.y=d+r-w.style.height:w.style.y+=h,"filler"==w._type?this._syncHandleShape():this._syncFillerShape(w),this.dataRangeOption.realtime&&this._syncData(),!0},__ondragend:function(){this.isDragend=!0},ondragend:function(d,a){this.isDragend&&d.target&&(!this.dataRangeOption.realtime&&this._syncData(),a.dragOut=!0,a.dragIn=!0,this.dataRangeOption.realtime||this.messageCenter.dispatch(v.EVENT.DATA_RANGE,null,{range:{start:this._range.end,end:this._range.start}},this.myChart),a.needRefresh=!1,this.isDragend=!1)},_syncShapeFromRange:function(){var h=this.dataRangeOption.range||{};if(this._range.end="undefined"!=typeof this._range.end?this._range.end:"undefined"!=typeof h.start?h.start:0,this._range.start="undefined"!=typeof this._range.start?this._range.start:"undefined"!=typeof h.end?h.end:100,100!=this._range.start||0!==this._range.end){if("horizontal"==this.dataRangeOption.orient){var d=this._fillerShape.style.width;this._fillerShape.style.x+=d*(100-this._range.start)/100,this._fillerShape.style.width=d*(this._range.start-this._range.end)/100}else{var a=this._fillerShape.style.height;this._fillerShape.style.y+=a*(100-this._range.start)/100,this._fillerShape.style.height=a*(this._range.start-this._range.end)/100}this.zr.modShape(this._fillerShape.id),this._syncHandleShape()}},_syncHandleShape:function(){var h=this._calculableLocation.x,d=this._calculableLocation.y,a=this._calculableLocation.width,l=this._calculableLocation.height;"horizontal"==this.dataRangeOption.orient?(this._startShape.style.x=this._fillerShape.style.x,this._startMask.style.width=this._startShape.style.x-h,this._endShape.style.x=this._fillerShape.style.x+this._fillerShape.style.width,this._endMask.style.x=this._endShape.style.x,this._endMask.style.width=h+a-this._endShape.style.x,this._range.start=Math.ceil(100-(this._startShape.style.x-h)/a*100),this._range.end=Math.floor(100-(this._endShape.style.x-h)/a*100)):(this._startShape.style.y=this._fillerShape.style.y,this._startMask.style.height=this._startShape.style.y-d,this._endShape.style.y=this._fillerShape.style.y+this._fillerShape.style.height,this._endMask.style.y=this._endShape.style.y,this._endMask.style.height=d+l-this._endShape.style.y,this._range.start=Math.ceil(100-(this._startShape.style.y-d)/l*100),this._range.end=Math.floor(100-(this._endShape.style.y-d)/l*100)),this._syncShape()},_syncFillerShape:function(w){var l,h,y=this._calculableLocation.x,d=this._calculableLocation.y,x=this._calculableLocation.width,r=this._calculableLocation.height;"horizontal"==this.dataRangeOption.orient?(l=this._startShape.style.x,h=this._endShape.style.x,w.id==this._startShape.id&&l>=h?(h=l,this._endShape.style.x=l):w.id==this._endShape.id&&l>=h&&(l=h,this._startShape.style.x=l),this._fillerShape.style.x=l,this._fillerShape.style.width=h-l,this._startMask.style.width=l-y,this._endMask.style.x=h,this._endMask.style.width=y+x-h,this._range.start=Math.ceil(100-(l-y)/x*100),this._range.end=Math.floor(100-(h-y)/x*100)):(l=this._startShape.style.y,h=this._endShape.style.y,w.id==this._startShape.id&&l>=h?(h=l,this._endShape.style.y=l):w.id==this._endShape.id&&l>=h&&(l=h,this._startShape.style.y=l),this._fillerShape.style.y=l,this._fillerShape.style.height=h-l,this._startMask.style.height=l-d,this._endMask.style.y=h,this._endMask.style.height=d+r-h,this._range.start=Math.ceil(100-(l-d)/r*100),this._range.end=Math.floor(100-(h-d)/r*100)),this._syncShape()},_syncShape:function(){this._startShape.position=[this._startShape.style.x-this._startShape.style._x,this._startShape.style.y-this._startShape.style._y],this._startShape.style.text=this._textFormat(this._gap*this._range.start+this.dataRangeOption.min),this._startShape.style.color=this._startShape.highlightStyle.strokeColor=this.getColor(this._gap*this._range.start+this.dataRangeOption.min),this._endShape.position=[this._endShape.style.x-this._endShape.style._x,this._endShape.style.y-this._endShape.style._y],this._endShape.style.text=this._textFormat(this._gap*this._range.end+this.dataRangeOption.min),this._endShape.style.color=this._endShape.highlightStyle.strokeColor=this.getColor(this._gap*this._range.end+this.dataRangeOption.min),this.zr.modShape(this._startShape.id),this.zr.modShape(this._endShape.id),this.zr.modShape(this._startMask.id),this.zr.modShape(this._endMask.id),this.zr.modShape(this._fillerShape.id),this.zr.refresh()},_syncData:function(){this.dataRangeOption.realtime&&this.messageCenter.dispatch(v.EVENT.DATA_RANGE,null,{range:{start:this._range.end,end:this._range.start}},this.myChart)},__dataRangeSelected:function(d){var a=d.target._idx;this._selectedMap[a]=!this._selectedMap[a],this.messageCenter.dispatch(v.EVENT.REFRESH,null,null,this.myChart)},__dispatchHoverLink:function(r){var l,h;if(this.dataRangeOption.calculable){var w,d=this.dataRangeOption.max-this.dataRangeOption.min;w="horizontal"==this.dataRangeOption.orient?(1-(g.getX(r.event)-this._calculableLocation.x)/this._calculableLocation.width)*d:(1-(g.getY(r.event)-this._calculableLocation.y)/this._calculableLocation.height)*d,l=w-0.05*d,h=w+0.05*d}else{var s=r.target._idx;h=(this._colorList.length-s)*this._gap+this.dataRangeOption.min,l=h-this._gap}this.messageCenter.dispatch(v.EVENT.DATA_RANGE_HOVERLINK,r.event,{valueMin:l,valueMax:h},this.myChart)},__onhoverlink:function(d){if(this.dataRangeOption.show&&this.dataRangeOption.hoverLink&&this._indicatorShape&&d&&null!=d.seriesIndex&&null!=d.dataIndex){var a=d.value;if(isNaN(a)){return}a<this.dataRangeOption.min?a=this.dataRangeOption.min:a>this.dataRangeOption.max&&(a=this.dataRangeOption.max),this._indicatorShape.position="horizontal"==this.dataRangeOption.orient?[(this.dataRangeOption.max-a)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._calculableLocation.width,0]:[0,(this.dataRangeOption.max-a)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._calculableLocation.height],this._indicatorShape.style.text=d.value,this._indicatorShape.style.color=this.getColor(a),this.zr.addHoverShape(this._indicatorShape)}},_textFormat:function(d,a){if(d=d.toFixed(this.dataRangeOption.precision),a="undefined"!=typeof a?a.toFixed(this.dataRangeOption.precision):"",this.dataRangeOption.formatter){if("string"==typeof this.dataRangeOption.formatter){return this.dataRangeOption.formatter.replace("{value}",d).replace("{value2}",a)}if("function"==typeof this.dataRangeOption.formatter){return this.dataRangeOption.formatter.call(this.myChart,d,a)}}return""!==a?d+" - "+a:d},refresh:function(w){if(w){this.option=w,this.option.dataRange=this.reformOption(this.option.dataRange),this.dataRangeOption=this.option.dataRange,this.myChart.canvasSupported||(this.dataRangeOption.realtime=!1);var l=this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?100:this.dataRangeOption.splitNumber;if(this._colorList=p.getGradientColors(this.dataRangeOption.color,Math.max((l-this.dataRangeOption.color.length)/(this.dataRangeOption.color.length-1),0)+1),this._colorList.length>l){for(var h=this._colorList.length,y=[this._colorList[0]],d=h/(l-1),x=1;l-1>x;x++){y.push(this._colorList[Math.floor(x*d)])}y.push(this._colorList[h-1]),this._colorList=y}var r=this.dataRangeOption.precision;for(this._gap=(this.dataRangeOption.max-this.dataRangeOption.min)/l;this._gap.toFixed(r)-0!=this._gap&&5>r;){r++}this.dataRangeOption.precision=r,this._gap=((this.dataRangeOption.max-this.dataRangeOption.min)/l).toFixed(r)-0,this._valueTextList=[];for(var x=0;l>x;x++){this._selectedMap[x]=!0,this._valueTextList.unshift(this._textFormat(x*this._gap+this.dataRangeOption.min,(x+1)*this._gap+this.dataRangeOption.min))}}this.clear(),this._buildShape()},getColor:function(d){if(isNaN(d)){return null}if(this.dataRangeOption.min==this.dataRangeOption.max){return this._colorList[0]}if(d<this.dataRangeOption.min?d=this.dataRangeOption.min:d>this.dataRangeOption.max&&(d=this.dataRangeOption.max),this.dataRangeOption.calculable&&(d-(this._gap*this._range.start+this.dataRangeOption.min)>0.00005||d-(this._gap*this._range.end+this.dataRangeOption.min)<-0.00005)){return null}var a=this._colorList.length-Math.ceil((d-this.dataRangeOption.min)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._colorList.length);return a==this._colorList.length&&a--,this._selectedMap[a]?this._colorList[a]:null},getColorByIndex:function(a){return a>=this._colorList.length?a=this._colorList.length-1:0>a&&(a=0),this._colorList[a]},onbeforDispose:function(){this.messageCenter.unbind(v.EVENT.HOVER,this._onhoverlink)}},b.inherits(u,j),m("../component").define("dataRange",u),u}),define("echarts/util/shape/HandlePolygon",["require","zrender/shape/Base","zrender/shape/Polygon","zrender/tool/util"],function(f){function d(a){c.call(this,a)}var c=f("zrender/shape/Base"),g=f("zrender/shape/Polygon"),b=f("zrender/tool/util");return d.prototype={type:"handle-polygon",buildPath:function(h,a){g.prototype.buildPath(h,a)},isCover:function(j,h){var a=this.getTansform(j,h);j=a[0],h=a[1];var k=this.style.rect;return j>=k.x&&j<=k.x+k.width&&h>=k.y&&h<=k.y+k.height?!0:!1}},b.inherits(d,c),d});