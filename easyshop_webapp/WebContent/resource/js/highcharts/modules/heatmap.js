(function(L){var K=L.Axis,b=L.Chart,E=L.Color,a=L.Legend,g=L.LegendSymbolMixin,f=L.Series,e=L.SVGRenderer,d=L.getOptions(),J=L.each,C=L.extend,D=L.extendClass,I=L.merge,H=L.pick,c=L.numberFormat,F=L.seriesTypes,B=L.wrap,G=function(){},i=L.ColorAxis=function(){this.isColorAxis=!0;this.init.apply(this,arguments)};C(i.prototype,K.prototype);C(i.prototype,{defaultColorAxisOptions:{lineWidth:0,gridLineWidth:1,tickPixelInterval:72,startOnTick:!0,endOnTick:!0,offset:0,marker:{animation:{duration:50},color:"gray",width:0.01},labels:{overflow:"justify"},minColor:"#EFEFFF",maxColor:"#003875",tickLength:5},init:function(h,j){var l=h.options.legend.layout!=="vertical",k;k=I(this.defaultColorAxisOptions,{side:l?2:1,reversed:!l},j,{isX:l,opposite:!l,showEmpty:!1,title:null,isColor:!0});K.prototype.init.call(this,h,k);j.dataClasses&&this.initDataClasses(j);this.initStops(j);this.isXAxis=!0;this.horiz=l;this.zoomEnabled=!1},tweenColors:function(h,j,l){var k=j.rgba[3]!==1||h.rgba[3]!==1;return(k?"rgba(":"rgb(")+Math.round(j.rgba[0]+(h.rgba[0]-j.rgba[0])*(1-l))+","+Math.round(j.rgba[1]+(h.rgba[1]-j.rgba[1])*(1-l))+","+Math.round(j.rgba[2]+(h.rgba[2]-j.rgba[2])*(1-l))+(k?","+(j.rgba[3]+(h.rgba[3]-j.rgba[3])*(1-l)):"")+")"},initDataClasses:function(h){var j=this,n=this.chart,m,l=0,k=this.options;this.dataClasses=m=[];this.legendItems=[];J(h.dataClasses,function(q,o){var p,q=I(q);m.push(q);if(!q.color){k.dataClassColor==="category"?(p=n.options.colors,q.color=p[l++],l===p.length&&(l=0)):q.color=j.tweenColors(E(k.minColor),E(k.maxColor),o/(h.dataClasses.length-1))}})},initStops:function(h){this.stops=h.stops||[[0,this.options.minColor],[1,this.options.maxColor]];J(this.stops,function(j){j.color=E(j[1])})},setOptions:function(h){K.prototype.setOptions.call(this,h);this.options.crosshair=this.options.marker;this.coll="colorAxis"},setAxisSize:function(){var h=this.legendSymbol,j=this.chart,m,l,k;if(h){this.left=m=h.attr("x"),this.top=l=h.attr("y"),this.width=k=h.attr("width"),this.height=h=h.attr("height"),this.right=j.chartWidth-m-k,this.bottom=j.chartHeight-l-h,this.len=this.horiz?k:h,this.pos=this.horiz?m:l}},toColor:function(h,j){var p,o=this.stops,n,m=this.dataClasses,l,k;if(m){for(k=m.length;k--;){if(l=m[k],n=l.from,o=l.to,(n===void 0||h>=n)&&(o===void 0||h<=o)){p=l.color;if(j){j.dataClass=k}break}}}else{this.isLog&&(h=this.val2lin(h));p=1-(this.max-h)/(this.max-this.min||1);for(k=o.length;k--;){if(p>o[k][0]){break}}n=o[k]||o[k+1];o=o[k+1]||n;p=1-(o[0]-p)/(o[0]-n[0]||1);p=this.tweenColors(n.color,o.color,p)}return p},getOffset:function(){var h=this.legendGroup,j=this.chart.axisOffset[this.side];if(h){K.prototype.getOffset.call(this);if(!this.axisGroup.parentGroup){this.axisGroup.add(h),this.gridGroup.add(h),this.labelGroup.add(h),this.added=!0}this.chart.axisOffset[this.side]=j}},setLegendColor:function(){var h,j=this.options;h=this.horiz?[0,0,1,0]:[0,0,0,1];this.legendColor={linearGradient:{x1:h[0],y1:h[1],x2:h[2],y2:h[3]},stops:j.stops||[[0,j.minColor],[1,j.maxColor]]}},drawLegendSymbol:function(h,j){var p=h.padding,o=h.options,n=this.horiz,m=H(o.symbolWidth,n?200:12),l=H(o.symbolHeight,n?12:200),k=H(o.labelPadding,n?16:30),o=H(o.itemDistance,10);this.setLegendColor();j.legendSymbol=this.chart.renderer.rect(0,h.baseline-11,m,l).attr({zIndex:1}).add(j.legendGroup);j.legendSymbol.getBBox();this.legendItemWidth=m+p+(n?o:k);this.legendItemHeight=l+p+(n?k:0)},setState:G,visible:!0,setVisible:G,getSeriesExtremes:function(){var h;if(this.series.length){h=this.series[0],this.dataMin=h.valueMin,this.dataMax=h.valueMax}},drawCrosshair:function(h,j){var p=!this.cross,o=j&&j.plotX,n=j&&j.plotY,m,l=this.pos,k=this.len;if(j){m=this.toPixels(j.value),m<l?m=l-2:m>l+k&&(m=l+k+2),j.plotX=m,j.plotY=this.len-m,K.prototype.drawCrosshair.call(this,h,j),j.plotX=o,j.plotY=n,!p&&this.cross&&this.cross.attr({fill:this.crosshair.color}).add(this.labelGroup)}},getPlotLinePath:function(h,j,m,l,k){return k?this.horiz?["M",k-4,this.top-6,"L",k+4,this.top-6,k,this.top,"Z"]:["M",this.left,k,"L",this.left-6,k+6,this.left-6,k-6,"Z"]:K.prototype.getPlotLinePath.call(this,h,j,m,l)},update:function(h,j){J(this.series,function(k){k.isDirtyData=!0});K.prototype.update.call(this,h,j);this.legendItem&&(this.setLegendColor(),this.chart.legend.colorizeItem(this,!0))},getDataClassLegendSymbols:function(){var h=this,j=this.chart,o=this.legendItems,n=j.options.legend,m=n.valueDecimals,l=n.valueSuffix||"",k;o.length||J(this.dataClasses,function(t,s){var r=!0,q=t.from,p=t.to;k="";q===void 0?k="< ":p===void 0&&(k="> ");q!==void 0&&(k+=c(q,m)+l);q!==void 0&&p!==void 0&&(k+=" - ");p!==void 0&&(k+=c(p,m)+l);o.push(C({chart:j,name:k,options:{},drawLegendSymbol:g.drawRectangle,visible:!0,setState:G,setVisible:function(){r=this.visible=!r;J(h.series,function(u){J(u.points,function(v){v.dataClass===s&&v.setVisible(r)})});j.legend.colorizeItem(this,r)}},t))});return o},name:""});B(b.prototype,"getAxes",function(h){var j=this.options.colorAxis;h.call(this);this.colorAxis=[];j&&new i(this,j)});B(a.prototype,"getAllItems",function(h){var j=[],k=this.chart.colorAxis[0];k&&(k.options.dataClasses?j=j.concat(k.getDataClassLegendSymbols()):j.push(k),J(k.series,function(l){l.options.showInLegend=!1}));return j.concat(h.call(this))});L={pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color",dashstyle:"dashStyle"},pointArrayMap:["value"],axisTypes:["xAxis","yAxis","colorAxis"],optionalAxis:"colorAxis",trackerGroups:["group","markerGroup","dataLabelsGroup"],getSymbol:G,parallelArrays:["x","y","value"],colorKey:"value",translateColors:function(){var h=this,j=this.options.nullColor,l=this.colorAxis,k=this.colorKey;J(this.data,function(n){var m=n[k];if(m=m===null?j:l&&m!==void 0?l.toColor(m,n):n.color||h.color){n.color=m}})}};B(e.prototype,"buildText",function(h,j){var k=j.styles&&j.styles.HcTextStroke;h.call(this,j);k&&j.applyTextStroke&&j.applyTextStroke(k)});e.prototype.Element.prototype.applyTextStroke=function(h){var j=this.element,l,k,h=h.split(" ");l=j.getElementsByTagName("tspan");k=j.firstChild;this.ySetter=this.xSetter;J([].slice.call(l),function(o,n){var m;n===0&&(o.setAttribute("x",j.getAttribute("x")),(n=j.getAttribute("y"))!==null&&o.setAttribute("y",n));m=o.cloneNode(1);m.setAttribute("stroke",h[1]);m.setAttribute("stroke-width",h[0]);m.setAttribute("stroke-linejoin","round");j.insertBefore(m,k)})};d.plotOptions.heatmap=I(d.plotOptions.scatter,{animation:!1,borderWidth:0,nullColor:"#F8F8F8",dataLabels:{formatter:function(){return this.point.value},verticalAlign:"middle",crop:!1,overflow:!1,style:{color:"white",fontWeight:"bold",HcTextStroke:"1px rgba(0,0,0,0.5)"}},marker:null,tooltip:{pointFormat:"{point.x}, {point.y}: {point.value}<br/>"},states:{normal:{animation:!0},hover:{brightness:0.2}}});F.heatmap=D(F.scatter,I(L,{type:"heatmap",pointArrayMap:["y","value"],hasPointSpecificOptions:!0,supportsDrilldown:!0,getExtremesFromAll:!0,init:function(){F.scatter.prototype.init.apply(this,arguments);this.pointRange=this.options.colsize||1;this.yAxis.axisPointRange=this.options.rowsize||1},translate:function(){var h=this.options,j=this.xAxis,k=this.yAxis;this.generatePoints();J(this.points,function(p){var o=(h.colsize||1)/2,n=(h.rowsize||1)/2,m=Math.round(j.len-j.translate(p.x-o,0,1,0,1)),o=Math.round(j.len-j.translate(p.x+o,0,1,0,1)),l=Math.round(k.translate(p.y-n,0,1,0,1)),n=Math.round(k.translate(p.y+n,0,1,0,1));p.plotX=(m+o)/2;p.plotY=(l+n)/2;p.shapeType="rect";p.shapeArgs={x:Math.min(m,o),y:Math.min(l,n),width:Math.abs(o-m),height:Math.abs(n-l)}});this.translateColors();this.chart.hasRendered&&J(this.points,function(l){l.shapeArgs.fill=l.color})},drawPoints:F.column.prototype.drawPoints,animate:G,getBox:G,drawLegendSymbol:g.drawRectangle,getExtremes:function(){f.prototype.getExtremes.call(this,this.valueData);this.valueMin=this.dataMin;this.valueMax=this.dataMax;f.prototype.getExtremes.call(this)}}))})(Highcharts);